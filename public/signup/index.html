<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up Page</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>

    <header class="site-header">
        <h1>Welcome to the sign-up page</h1>
    </header>

    <div class="signup-container">
        <div class="error-message" hidden="">
            Error: Username already exists
        </div>

        <h2>Sign Up</h2>
        <form id="signupForm">
            <div class="input-group">
                <label for="username">Username:</label>
                <input type="text" id="username" name="username" required="">
            </div>

            <div class="input-group">
                <label for="password">Password:</label>
                <input  type="password" 
    title="Must contain at least one number, one uppercase and lowercase letter, and at least 12 or more characters" 
    id="password" 
    name="password" 
    required 
    pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{12,}">
            </div>

            <div class="btn-group">
                <button type="submit" class="signup-btn">Sign Up</button>
                <button type="button" class="return-btn" onclick="window.location.href='http://localhost:3000/'">Return</button>
                <button type="reset" class="clear-btn">Clear</button>

                
            </div>

            <div class="separator">
                <hr>
                <span>OR</span>
                <hr>
            </div>


            <button type="button" class="passkey-btn"
             onclick="window.location.href='/login/passkey.html'">
                ðŸ”‘ Sign up with Passkey
            </button>
        </form>

        <!-- âœ… Placeholder for QR Code -->
        <div id="qrContainer" style="display: none; text-align: center;">
            <h3>Scan this QR Code in Google Authenticator</h3>
            <img id="qrCode" src="" alt="QR Code">
        </div>
    </div>

    <script>
        document.getElementById("signupForm").addEventListener("submit", async function(event) {
            event.preventDefault(); // Prevent traditional form submission

            const username = document.getElementById("username").value;
            const password = document.getElementById("password").value;

            const response = await fetch("/submitSignup", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ username, password })
            });

            const data = await response.json();

            if (data.qrImage) {
                // âœ… Show QR Code
                document.getElementById("qrCode").src = data.qrImage;
                document.getElementById("qrContainer").style.display = "block";
            } else {
                document.querySelector(".error-message").style.display = "block";
            }
        });
    </script>



</body></html>